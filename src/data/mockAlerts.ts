import { AlertPlaybook, AlertCategory } from "@/types/alert";

export const mockAlerts: AlertPlaybook[] = [
  {
    id: 'brute-force',
    name: 'Brute Force Attack',
    category: 'Authentication',
    description: 'A high volume of failed login attempts targeting a single or multiple accounts over a short period, indicating an automated credential guessing attempt.',
    causes: [
      'Weak passwords being targeted.',
      'Automated scripts or bots attempting credential stuffing.',
      'Misconfigured rate limiting or account lockout policies on login endpoints.',
    ],
    actions: [
      'Step 1: **Verify the Alert.** Confirm the volume and rate of failed logins in the SIEM/Log Analytics tool.',
      'Step 2: **Identify Targets.** Determine the source IP address(es) and the specific user account(s) being targeted.',
      'Step 3: **Check for Success.** Search logs immediately to see if any login attempts from the source IP were successful during the attack window.',
      'Step 4: **Containment (Source).** If the source IP is external and malicious, block it temporarily at the perimeter firewall or WAF.',
      'Step 5: **Containment (Account).** If a specific user account was successfully compromised, immediately disable or suspend the account.',
      'Step 6: **Mitigation.** Force a password reset for all targeted user accounts, successful or not, and enforce Multi-Factor Authentication (MFA).',
      'Step 7: **Post-Incident Review.** Review authentication logs for signs of lateral movement or resource access by the compromised account (if applicable).',
    ],
    queries: [
      { tool: 'Splunk', query: 'index=auth sourcetype=login status=failure | stats count by src_ip, user | where count > 50 | sort -count' },
      { tool: 'Wazuh', query: 'rule.groups:authentication_failure AND srcip != "internal_network" | group by srcip, user' },
    ],
    tools: ['SIEM/Log Analytics', 'Firewall/WAF', 'Identity Provider (IdP) Management Console'],
    escalation: 'Escalate to Incident Response Team (IRT) if successful login is confirmed, or if the attack source cannot be blocked and persists.',
  },
  {
    id: 'phishing-email',
    name: 'Phishing Email Detected',
    category: 'Data Security',
    description: 'An email flagged by security tools or reported by a user containing malicious links, attachments, or impersonation attempts aimed at stealing credentials or deploying malware.',
    causes: [
      'User clicked a malicious link or opened an attachment.',
      'Lack of robust email filtering/DMARC/SPF/DKIM configuration allowed the email through.',
      'Targeted spear-phishing campaign.',
    ],
    actions: [
      'Step 1: **Isolate and Analyze.** Forward the suspicious email to the security mailbox for analysis. Do NOT click links or open attachments.',
      'Step 2: **Analyze Headers.** Examine email headers (sender, recipient, mail flow) to determine the true origin and authenticity.',
      'Step 3: **Containment (Email).** If confirmed malicious, use the Email Security Gateway (ESG) to search for and immediately remove the email from all user inboxes across the organization.',
      'Step 4: **Containment (Endpoint).** If an attachment was opened or a link was clicked, isolate the affected user endpoint from the network.',
      'Step 5: **Scan and Remediate.** Run a full scan on the isolated endpoint using EDR tools. If malware is found, follow the Malware Outbreak playbook.',
      'Step 6: **User Notification.** Notify the affected user(s) about the incident and provide immediate, targeted security awareness training on phishing indicators.',
      'Step 7: **Block Indicators.** Add malicious sender addresses, domains, and file hashes to perimeter block lists (Firewall, ESG).',
    ],
    queries: [
      { tool: 'Microsoft Defender', query: 'EmailEvents | where ThreatTypes contains "Phish" and DeliveryAction == "Delivered"' },
      { tool: 'ESG', query: 'search subject="Invoice Q3" AND attachment_hash="[MALICIOUS_HASH]"' },
    ],
    tools: ['Email Security Gateway (ESG)', 'Sandbox Analysis Tool', 'Endpoint Detection and Response (EDR)'],
    escalation: 'Escalate if credentials were entered, malware infection is confirmed, or if the campaign is widespread (affecting >5% of users).',
  },
  {
    id: 'malware-outbreak',
    name: 'Malware Outbreak',
    category: 'Endpoint',
    description: 'Multiple endpoints reporting detection of the same or related malware strain simultaneously, often leading to widespread disruption or data encryption.',
    causes: [
      'Successful exploitation of a vulnerability in a common software (e.g., unpatched browser or OS).',
      'Successful phishing campaign leading to execution of malicious payload.',
      'Uncontrolled external media usage (USB drives).',
    ],
    actions: [
      'Step 1: **Initial Triage.** Identify the malware family, the initial point of compromise ("Patient Zero"), and the current scope of infection.',
      'Step 2: **Containment (Network).** Immediately isolate all affected endpoints from the network using EDR or Network Access Control (NAC). Do NOT shut down the machines.',
      'Step 3: **Containment (Process).** Use EDR to terminate all related malicious processes across all affected hosts.',
      'Step 4: **Indicator Extraction.** Extract all Indicators of Compromise (IOCs): file hashes, C2 domains/IPs, registry keys, and process names.',
      'Step 5: **Block IOCs.** Push extracted IOCs to perimeter defenses (Firewall, IDS/IPS) and EDR policies to prevent further spread.',
      'Step 6: **Remediation.** Clean the infected systems using EDR tools or re-image the hosts if necessary. Ensure backups are clean.',
      'Step 7: **Root Cause Analysis.** Determine the initial vector (e.g., patch vulnerability, user action) and apply necessary preventative controls.',
    ],
    queries: [
      { tool: 'EDR', query: 'Process: Create, File: Write, Network: Connect | where MalwareName = "RansomwareX" | group by hostname' },
      { tool: 'Vulnerability Scanner', query: 'search host="[PATIENT_ZERO]" and vulnerability_score > 8.0' },
    ],
    tools: ['EDR', 'Network Access Control (NAC)', 'Vulnerability Scanner', 'Forensic Toolkit'],
    escalation: 'High priority. Engage Crisis Management Team immediately if ransomware is involved or critical systems are affected.',
  },
  {
    id: 'suspicious-network-traffic',
    name: 'Suspicious Outbound Network Traffic (C2)',
    category: 'Network',
    description: 'Unusual high volume or connections from an internal host to known malicious IPs or non-standard ports, often indicating Command and Control (C2) activity or data exfiltration.',
    causes: [
      'Internal host is compromised and communicating with an external C2 server.',
      'Data exfiltration attempt using non-standard protocols.',
      'Misconfigured application or service generating false positives.',
    ],
    actions: [
      'Step 1: **Validate Destination.** Check the destination IP/domain against threat intelligence feeds (e.g., VirusTotal, AlienVault) to confirm malicious intent.',
      'Step 2: **Identify Source.** Determine the source host (IP and hostname) and the specific process generating the traffic.',
      'Step 3: **Containment.** Immediately isolate the source host from the network using EDR or NAC.',
      'Step 4: **Perimeter Block.** Block the destination IP/domain at the perimeter firewall/proxy to prevent further communication.',
      'Step 5: **Forensic Analysis.** Perform a deep forensic analysis on the isolated host to identify the malware, persistence mechanisms, and scope of compromise.',
      'Step 6: **Review PCAPs.** Analyze packet captures (PCAPs) if available to understand the data being transmitted and the communication protocol.',
    ],
    queries: [
      { tool: 'SIEM/Log Analytics', query: 'index=network traffic_outbound | where dest_ip IN (malicious_ip_list) | top limit=10 src_ip' },
      { tool: 'Firewall Logs', query: 'search action=allowed AND dest_port=4444 AND src_ip="[INTERNAL_HOST_IP]"' },
    ],
    tools: ['Network Monitoring Tools (NMS)', 'Firewall Logs', 'IDS/IPS', 'EDR'],
    escalation: 'Escalate if data exfiltration is confirmed, or if the traffic is coming from a critical server.',
  },
  {
    id: 'cloud-storage-exposure',
    name: 'Public Cloud Storage Exposure',
    category: 'Cloud',
    description: 'Detection of a cloud storage bucket (e.g., S3, Azure Blob) configured for public read or write access, potentially exposing sensitive data.',
    causes: [
      'Misconfiguration during deployment (e.g., "Everyone" access granted).',
      'Automated script error or manual oversight.',
      'Lack of continuous cloud security posture management (CSPM).',
    ],
    actions: [
      'Step 1: **Verify Public Access.** Immediately confirm the public access status of the identified bucket using the cloud provider console (AWS/Azure/GCP).',
      'Step 2: **Containment.** Change the bucket policy immediately to restrict access to internal users only (or specific roles/IPs).',
      'Step 3: **Scope Assessment.** Determine what data was stored in the bucket and if it contained sensitive information (PII, credentials, proprietary data).',
      'Step 4: **Audit Logs.** Review cloud access logs for the bucket to identify any unauthorized external access or downloads during the exposure window.',
      'Step 5: **Remediation.** If sensitive data was exposed, follow data breach notification procedures.',
      'Step 6: **Preventative Action.** Update Infrastructure as Code (IaC) templates and enforce CSPM policies to prevent recurrence.',
    ],
    queries: [
      { tool: 'AWS CloudTrail', query: 'eventName=PutBucketAcl AND requestParameters.acl="public-read"' },
      { tool: 'CSPM Tool', query: 'search resource_type="s3_bucket" AND public_access="true"' },
    ],
    tools: ['Cloud Provider Console (IAM/Storage)', 'CSPM Tool', 'Cloud Access Logs'],
    escalation: 'Escalate immediately if PII, financial data, or critical intellectual property was exposed.',
  },
  {
    id: 'privilege-escalation',
    name: 'Local Privilege Escalation',
    category: 'Endpoint',
    description: 'A standard user account successfully gaining elevated privileges (e.g., root or administrator) on a local system.',
    causes: [
      'Exploitation of a known OS or application vulnerability (e.g., kernel bug).',
      'Misconfigured service permissions allowing low-privilege users to modify system files.',
      'Use of stolen or weak service account credentials.',
    ],
    actions: [
      'Step 1: **Isolate Host.** Immediately isolate the affected endpoint from the network.',
      'Step 2: **Identify Method.** Determine the method used for privilege escalation (e.g., specific exploit, misconfiguration abuse, credential theft).',
      'Step 3: **Capture Snapshot.** Take a memory and disk image snapshot of the compromised system for deep forensic analysis.',
      'Step 4: **Identify Persistence.** Check for new user accounts, scheduled tasks, or modified registry keys created by the attacker for persistence.',
      'Step 5: **Patch/Remediate.** Apply the necessary patch or correct the misconfiguration that allowed the escalation.',
      'Step 6: **Re-image.** Re-image the host to ensure complete removal of any hidden malicious components.',
    ],
    queries: [
      { tool: 'EDR', query: 'Process: Create AND parent_process="low_privilege_user" AND new_process="system_shell"' },
      { tool: 'Windows Event Log', query: 'EventID=4672 (Special Privileges Assigned)' },
    ],
    tools: ['EDR', 'Forensic Toolkit', 'Vulnerability Scanner'],
    escalation: 'Escalate if the escalation leads to lateral movement or compromise of critical domain accounts.',
  },
];

export const categories: AlertCategory[] = ['Authentication', 'Network', 'Endpoint', 'Data Security', 'Cloud', 'Other'];